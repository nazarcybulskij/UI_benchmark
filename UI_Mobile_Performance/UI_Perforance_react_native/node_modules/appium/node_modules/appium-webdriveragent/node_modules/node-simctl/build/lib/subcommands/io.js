"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

require("source-map-support/register");

var _appiumSupport = require("appium-support");

var _path = _interopRequireDefault(require("path"));

const commands = {};

commands.getScreenshot = async function getScreenshot() {
  const udid = this.requireUdid('io screenshot');
  const tmpRoot = await _appiumSupport.tempDir.openDir();

  try {
    const pathToScreenshotPng = _path.default.resolve(tmpRoot, 'screenshot.png');

    await this.exec('io', {
      args: [udid, 'screenshot', pathToScreenshotPng]
    });
    return (await _appiumSupport.fs.readFile(pathToScreenshotPng)).toString('base64');
  } finally {
    await _appiumSupport.fs.rimraf(tmpRoot);
  }
};

var _default = commands;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9zdWJjb21tYW5kcy9pby5qcyJdLCJuYW1lcyI6WyJjb21tYW5kcyIsImdldFNjcmVlbnNob3QiLCJ1ZGlkIiwicmVxdWlyZVVkaWQiLCJ0bXBSb290IiwidGVtcERpciIsIm9wZW5EaXIiLCJwYXRoVG9TY3JlZW5zaG90UG5nIiwicGF0aCIsInJlc29sdmUiLCJleGVjIiwiYXJncyIsImZzIiwicmVhZEZpbGUiLCJ0b1N0cmluZyIsInJpbXJhZiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTs7QUFDQTs7QUFFQSxNQUFNQSxRQUFRLEdBQUcsRUFBakI7O0FBWUFBLFFBQVEsQ0FBQ0MsYUFBVCxHQUF5QixlQUFlQSxhQUFmLEdBQWdDO0FBQ3ZELFFBQU1DLElBQUksR0FBRyxLQUFLQyxXQUFMLENBQWlCLGVBQWpCLENBQWI7QUFDQSxRQUFNQyxPQUFPLEdBQUcsTUFBTUMsdUJBQVFDLE9BQVIsRUFBdEI7O0FBQ0EsTUFBSTtBQUNGLFVBQU1DLG1CQUFtQixHQUFHQyxjQUFLQyxPQUFMLENBQWFMLE9BQWIsRUFBc0IsZ0JBQXRCLENBQTVCOztBQUNBLFVBQU0sS0FBS00sSUFBTCxDQUFVLElBQVYsRUFBZ0I7QUFDcEJDLE1BQUFBLElBQUksRUFBRSxDQUFDVCxJQUFELEVBQU8sWUFBUCxFQUFxQkssbUJBQXJCO0FBRGMsS0FBaEIsQ0FBTjtBQUdBLFdBQU8sQ0FBQyxNQUFNSyxrQkFBR0MsUUFBSCxDQUFZTixtQkFBWixDQUFQLEVBQXlDTyxRQUF6QyxDQUFrRCxRQUFsRCxDQUFQO0FBQ0QsR0FORCxTQU1VO0FBQ1IsVUFBTUYsa0JBQUdHLE1BQUgsQ0FBVVgsT0FBVixDQUFOO0FBQ0Q7QUFDRixDQVpEOztlQWNlSixRIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdGVtcERpciwgZnMgfSBmcm9tICdhcHBpdW0tc3VwcG9ydCc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuY29uc3QgY29tbWFuZHMgPSB7fTtcblxuLyoqXG4gKiBHZXRzIGJhc2U2NCBzY3JlZW5zaG90IGZvciBkZXZpY2VcbiAqIEl0IGlzIHJlcXVpcmVkIHRoYXQgU2ltdWxhdG9yIGlzIGluIF9ib290ZWRfIHN0YXRlLlxuICpcbiAqIEBzaW5jZSBYY29kZSBTREsgOC4xXG4gKiBAcmV0dXJuIHtzdHJpbmd9IEJhc2U2NC1lbmNvZGVkIFNpbXVsYXRvciBzY3JlZW5zaG90LlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBjb3JyZXNwb25kaW5nIHNpbWN0bCBzdWJjb21tYW5kIGNvbW1hbmRcbiAqICAgICAgICAgICAgICAgICByZXR1cm5zIG5vbi16ZXJvIHJldHVybiBjb2RlLlxuICogQHRocm93cyB7RXJyb3J9IElmIHRoZSBgdWRpZGAgaW5zdGFuY2UgcHJvcGVydHkgaXMgdW5zZXRcbiAqL1xuY29tbWFuZHMuZ2V0U2NyZWVuc2hvdCA9IGFzeW5jIGZ1bmN0aW9uIGdldFNjcmVlbnNob3QgKCkge1xuICBjb25zdCB1ZGlkID0gdGhpcy5yZXF1aXJlVWRpZCgnaW8gc2NyZWVuc2hvdCcpO1xuICBjb25zdCB0bXBSb290ID0gYXdhaXQgdGVtcERpci5vcGVuRGlyKCk7XG4gIHRyeSB7XG4gICAgY29uc3QgcGF0aFRvU2NyZWVuc2hvdFBuZyA9IHBhdGgucmVzb2x2ZSh0bXBSb290LCAnc2NyZWVuc2hvdC5wbmcnKTtcbiAgICBhd2FpdCB0aGlzLmV4ZWMoJ2lvJywge1xuICAgICAgYXJnczogW3VkaWQsICdzY3JlZW5zaG90JywgcGF0aFRvU2NyZWVuc2hvdFBuZ10sXG4gICAgfSk7XG4gICAgcmV0dXJuIChhd2FpdCBmcy5yZWFkRmlsZShwYXRoVG9TY3JlZW5zaG90UG5nKSkudG9TdHJpbmcoJ2Jhc2U2NCcpO1xuICB9IGZpbmFsbHkge1xuICAgIGF3YWl0IGZzLnJpbXJhZih0bXBSb290KTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgY29tbWFuZHM7XG4iXSwiZmlsZSI6ImxpYi9zdWJjb21tYW5kcy9pby5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
