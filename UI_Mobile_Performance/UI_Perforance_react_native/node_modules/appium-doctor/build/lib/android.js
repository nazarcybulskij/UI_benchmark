"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
Object.defineProperty(exports, "EnvVarAndPathCheck", {
  enumerable: true,
  get: function () {
    return _env.default;
  }
});
exports.default = exports.OptionalGstreamerCheck = exports.OptionalAppBundleCheck = exports.JavaOnPathCheck = exports.AndroidToolCheck = void 0;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

require("source-map-support/register");

var _doctor = require("./doctor");

var _utils = require("./utils");

var _appiumSupport = require("appium-support");

var _path = _interopRequireDefault(require("path"));

var _env = _interopRequireDefault(require("./env"));

require("colors");

let checks = [];
let javaHome = _appiumSupport.system.isWindows() ? '%JAVA_HOME%' : '$JAVA_HOME';
checks.push(new _env.default('ANDROID_HOME'));
checks.push(new _env.default('JAVA_HOME'));

class JavaOnPathCheck extends _doctor.DoctorCheck {
  async diagnose() {
    if (process.env.JAVA_HOME) {
      let javaHomeBin = _path.default.resolve(process.env.JAVA_HOME, 'bin');

      if (process.env.PATH.indexOf(javaHomeBin) + 1) {
        return (0, _utils.ok)(`Bin directory of ${javaHome} is set`);
      }
    }

    return (0, _utils.nok)(`Bin directory for ${javaHome} is not set`);
  }

  fix() {
    return `Add ${`'${javaHome}${_path.default.sep}bin'`.bold} to your ${'PATH'.bold} environment`;
  }

}

exports.JavaOnPathCheck = JavaOnPathCheck;

class AndroidToolCheck extends _doctor.DoctorCheck {
  constructor(toolName, toolPath) {
    super();
    this.toolName = toolName;
    this.toolPath = toolPath;
  }

  async diagnose() {
    if (typeof process.env.ANDROID_HOME === 'undefined') {
      return (0, _utils.nok)(`${this.toolName} could not be found because ANDROID_HOME is NOT set!`);
    }

    let fullPath = _path.default.resolve(process.env.ANDROID_HOME, this.toolPath);

    return (await _appiumSupport.fs.exists(fullPath)) ? (0, _utils.ok)(`${this.toolName} exists at: ${fullPath}`) : (0, _utils.nok)(`${this.toolName} could NOT be found at '${fullPath}'!`);
  }

  fix() {
    if (typeof process.env.ANDROID_HOME === 'undefined') {
      return `Manually configure ${'ANDROID_HOME'.bold} and run appium-doctor again.`;
    }

    return `Manually install ${this.toolName.bold} and add it to ${'PATH'.bold}.`;
  }

}

exports.AndroidToolCheck = AndroidToolCheck;
checks.push(new AndroidToolCheck('adb', _path.default.join('platform-tools', _appiumSupport.system.isWindows() ? 'adb.exe' : 'adb')));
checks.push(new AndroidToolCheck('android', _path.default.join('tools', _appiumSupport.system.isWindows() ? 'android.bat' : 'android')));
checks.push(new AndroidToolCheck('emulator', _path.default.join('tools', _appiumSupport.system.isWindows() ? 'emulator.exe' : 'emulator')));
checks.push(new JavaOnPathCheck());

class OptionalAppBundleCheck extends _doctor.DoctorCheck {
  async diagnose() {
    const bundletoolPath = await (0, _utils.resolveExecutablePath)('bundletool.jar');
    return bundletoolPath ? (0, _utils.okOptional)(`bundletool.jar is installed at: ${bundletoolPath}`) : (0, _utils.nokOptional)('bundletool.jar cannot be found');
  }

  async fix() {
    return `${'bundletool.jar'.bold} is used to handle Android App Bundle. Please read http://appium.io/docs/en/writing-running-appium/android/android-appbundle/ to install it` + `${_appiumSupport.system.isWindows() ? '. Also consider adding the ".jar" extension into your PATHEXT environment variable in order to fix the problem for Windows' : ''}`;
  }

}

exports.OptionalAppBundleCheck = OptionalAppBundleCheck;
checks.push(new OptionalAppBundleCheck());

class OptionalGstreamerCheck extends _doctor.DoctorCheck {
  constructor(...args) {
    super(...args);
    (0, _defineProperty2.default)(this, "GSTREAMER_BINARY", `gst-launch-1.0${_appiumSupport.system.isWindows() ? '.exe' : ''}`);
    (0, _defineProperty2.default)(this, "GST_INSPECT_BINARY", `gst-inspect-1.0${_appiumSupport.system.isWindows() ? '.exe' : ''}`);
  }

  async diagnose() {
    const gstreamerPath = await (0, _utils.resolveExecutablePath)(this.GSTREAMER_BINARY);
    const gstInspectPath = await (0, _utils.resolveExecutablePath)(this.GST_INSPECT_BINARY);
    return gstreamerPath && gstInspectPath ? (0, _utils.okOptional)(`${this.GSTREAMER_BINARY} and ${this.GST_INSPECT_BINARY} are installed at: ${gstreamerPath} and ${gstInspectPath}`) : (0, _utils.nokOptional)(`${this.GSTREAMER_BINARY} and/or ${this.GST_INSPECT_BINARY} cannot be found`);
  }

  async fix() {
    return `${`${this.GSTREAMER_BINARY} and ${this.GST_INSPECT_BINARY}`.bold} are used to stream the screen of the device under test. ` + 'Please read https://appium.io/docs/en/writing-running-appium/android/android-screen-streaming/ to install them and for more details';
  }

}

exports.OptionalGstreamerCheck = OptionalGstreamerCheck;
checks.push(new OptionalGstreamerCheck());
var _default = checks;
exports.default = _default;require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxpYi9hbmRyb2lkLmpzIl0sIm5hbWVzIjpbImNoZWNrcyIsImphdmFIb21lIiwic3lzdGVtIiwiaXNXaW5kb3dzIiwicHVzaCIsIkVudlZhckFuZFBhdGhDaGVjayIsIkphdmFPblBhdGhDaGVjayIsIkRvY3RvckNoZWNrIiwiZGlhZ25vc2UiLCJwcm9jZXNzIiwiZW52IiwiSkFWQV9IT01FIiwiamF2YUhvbWVCaW4iLCJwYXRoIiwicmVzb2x2ZSIsIlBBVEgiLCJpbmRleE9mIiwiZml4Iiwic2VwIiwiYm9sZCIsIkFuZHJvaWRUb29sQ2hlY2siLCJjb25zdHJ1Y3RvciIsInRvb2xOYW1lIiwidG9vbFBhdGgiLCJBTkRST0lEX0hPTUUiLCJmdWxsUGF0aCIsImZzIiwiZXhpc3RzIiwiam9pbiIsIk9wdGlvbmFsQXBwQnVuZGxlQ2hlY2siLCJidW5kbGV0b29sUGF0aCIsIk9wdGlvbmFsR3N0cmVhbWVyQ2hlY2siLCJnc3RyZWFtZXJQYXRoIiwiR1NUUkVBTUVSX0JJTkFSWSIsImdzdEluc3BlY3RQYXRoIiwiR1NUX0lOU1BFQ1RfQklOQVJZIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUEsSUFBSUEsTUFBTSxHQUFHLEVBQWI7QUFFQSxJQUFJQyxRQUFRLEdBQUdDLHNCQUFPQyxTQUFQLEtBQXFCLGFBQXJCLEdBQXFDLFlBQXBEO0FBRUFILE1BQU0sQ0FBQ0ksSUFBUCxDQUFZLElBQUlDLFlBQUosQ0FBdUIsY0FBdkIsQ0FBWjtBQUNBTCxNQUFNLENBQUNJLElBQVAsQ0FBWSxJQUFJQyxZQUFKLENBQXVCLFdBQXZCLENBQVo7O0FBR0EsTUFBTUMsZUFBTixTQUE4QkMsbUJBQTlCLENBQTBDO0FBQ3hDLFFBQU1DLFFBQU4sR0FBa0I7QUFDaEIsUUFBSUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFNBQWhCLEVBQTJCO0FBQ3pCLFVBQUlDLFdBQVcsR0FBR0MsY0FBS0MsT0FB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c0JBQU9DLFNBQVAsS0FBcUIsNEhBQXJCLEdBQW9KLEVBQUcsRUFENUo7QUFFRDs7QUFYOEM7OztBQWFqREgsTUFBTSxDQUFDSSxJQUFQLENBQVksSUFBSXlCLHNCQUFKLEVBQVo7O0FBRUEsTUFBTUUsc0JBQU4sU0FBcUN4QixtQkFBckMsQ0FBaUQ7QUFBQTtBQUFBO0FBQUEsNERBQzNCLGlCQUFnQkwsc0JBQU9DLFNBQVAsS0FBcUIsTUFBckIsR0FBOEIsRUFBRyxFQUR0QjtBQUFBLDhEQUV6QixrQkFBaUJELHNCQUFPQyxTQUFQLEtBQXFCLE1BQXJCLEdBQThCLEVBQUcsRUFGekI7QUFBQTs7QUFJL0MsUUFBTUssUUFBTixHQUFrQjtBQUNoQixVQUFNd0IsYUFBYSxHQUFHLE1BQU0sa0NBQXNCLEtBQUtDLGdCQUEzQixDQUE1QjtBQUNBLFVBQU1DLGNBQWMsR0FBRyxNQUFNLGtDQUFzQixLQUFLQyxrQkFBM0IsQ0FBN0I7QUFFQSxXQUFPSCxhQUFhLElBQUlFLGNBQWpCLEdBQ0gsdUJBQVksR0FBRSxLQUFLRCxnQkFBaUIsUUFBTyxLQUFLRSxrQkFBbUIsc0JBQXFCSCxhQUFjLFFBQU9FLGNBQWUsRUFBNUgsQ0FERyxHQUVILHdCQUFhLEdBQUUsS0FBS0QsZ0JBQWlCLFdBQVUsS0FBS0Usa0JBQW1CLGtCQUF2RSxDQUZKO0FBR0Q7O0FBRUQsUUFBTWxCLEdBQU4sR0FBYTtBQUNYLFdBQVEsR0FBRyxHQUFFLEtBQUtnQixnQkFBaUIsUUFBTyxLQUFLRSxrQkFBbUIsRUFBeEQsQ0FBMERoQixJQUFLLDJEQUFsRSxHQUNMLHFJQURGO0FBRUQ7O0FBaEI4Qzs7O0FBa0JqRG5CLE1BQU0sQ0FBQ0ksSUFBUCxDQUFZLElBQUkyQixzQkFBSixFQUFaO2VBR2UvQixNIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRG9jdG9yQ2hlY2sgfSBmcm9tICcuL2RvY3Rvcic7XG5pbXBvcnQgeyBvaywgbm9rLCBva09wdGlvbmFsLCBub2tPcHRpb25hbCwgcmVzb2x2ZUV4ZWN1dGFibGVQYXRoIH0gZnJvbSAnLi91dGlscyc7XG5pbXBvcnQgeyBmcywgc3lzdGVtIH0gZnJvbSAnYXBwaXVtLXN1cHBvcnQnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgRW52VmFyQW5kUGF0aENoZWNrIGZyb20gJy4vZW52JztcbmltcG9ydCAnY29sb3JzJztcblxubGV0IGNoZWNrcyA9IFtdO1xuXG5sZXQgamF2YUhvbWUgPSBzeXN0ZW0uaXNXaW5kb3dzKCkgPyAnJUpBVkFfSE9NRSUnIDogJyRKQVZBX0hPTUUnO1xuXG5jaGVja3MucHVzaChuZXcgRW52VmFyQW5kUGF0aENoZWNrKCdBTkRST0lEX0hPTUUnKSk7XG5jaGVja3MucHVzaChuZXcgRW52VmFyQW5kUGF0aENoZWNrKCdKQVZBX0hPTUUnKSk7XG5cbi8vIENoZWNrIHRoYXQgdGhlIFBBVEggaW5jbHVkZXMgdGhlIGpkaydzIGJpbiBkaXJlY3RvcnlcbmNsYXNzIEphdmFPblBhdGhDaGVjayBleHRlbmRzIERvY3RvckNoZWNrIHtcbiAgYXN5bmMgZGlhZ25vc2UgKCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlcXVpcmUtYXdhaXRcbiAgICBpZiAocHJvY2Vzcy5lbnYuSkFWQV9IT01FKSB7XG4gICAgICBsZXQgamF2YUhvbWVCaW4gPSBwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuSkFWQV9IT01FLCAnYmluJyk7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuUEFUSC5pbmRleE9mKGphdmFIb21lQmluKSArIDEpIHtcbiAgICAgICAgcmV0dXJuIG9rKGBCaW4gZGlyZWN0b3J5IG9mICR7amF2YUhvbWV9IGlzIHNldGApO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbm9rKGBCaW4gZGlyZWN0b3J5IGZvciAke2phdmFIb21lfSBpcyBub3Qgc2V0YCk7XG4gIH1cblxuICBmaXggKCkge1xuICAgIHJldHVybiBgQWRkICR7YCcke2phdmFIb21lfSR7cGF0aC5zZXB9YmluJ2AuYm9sZH0gdG8geW91ciAkeydQQVRIJy5ib2xkfSBlbnZpcm9ubWVudGA7XG4gIH1cbn1cblxuLy8gQ2hlY2sgdG9vbHNcbmNsYXNzIEFuZHJvaWRUb29sQ2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGNvbnN0cnVjdG9yICh0b29sTmFtZSwgdG9vbFBhdGgpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMudG9vbE5hbWUgPSB0b29sTmFtZTtcbiAgICB0aGlzLnRvb2xQYXRoID0gdG9vbFBhdGg7XG4gIH1cblxuICBhc3luYyBkaWFnbm9zZSAoKSB7XG4gICAgaWYgKHR5cGVvZiBwcm9jZXNzLmVudi5BTkRST0lEX0hPTUUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICByZXR1cm4gbm9rKGAke3RoaXMudG9vbE5hbWV9IGNvdWxkIG5vdCBiZSBmb3VuZCBiZWNhdXNlIEFORFJPSURfSE9NRSBpcyBOT1Qgc2V0IWApO1xuICAgIH1cbiAgICBsZXQgZnVsbFBhdGggPSBwYXRoLnJlc29sdmUocHJvY2Vzcy5lbnYuQU5EUk9JRF9IT01FLCB0aGlzLnRvb2xQYXRoKTtcbiAgICByZXR1cm4gYXdhaXQgZnMuZXhpc3RzKGZ1bGxQYXRoKSA/IG9rKGAke3RoaXMudG9vbE5hbWV9IGV4aXN0cyBhdDogJHtmdWxsUGF0aH1gKSA6XG4gICAgICBub2soYCR7dGhpcy50b29sTmFtZX0gY291bGQgTk9UIGJlIGZvdW5kIGF0ICcke2Z1bGxQYXRofSchYCk7XG4gIH1cblxuICBmaXggKCkge1xuICAgIGlmICh0eXBlb2YgcHJvY2Vzcy5lbnYuQU5EUk9JRF9IT01FID09PSAndW5kZWZpbmVkJykge1xuICAgICAgcmV0dXJuIGBNYW51YWxseSBjb25maWd1cmUgJHsnQU5EUk9JRF9IT01FJy5ib2xkfSBhbmQgcnVuIGFwcGl1bS1kb2N0b3IgYWdhaW4uYDtcbiAgICB9XG4gICAgcmV0dXJuIGBNYW51YWxseSBpbnN0YWxsICR7dGhpcy50b29sTmFtZS5ib2xkfSBhbmQgYWRkIGl0IHRvICR7J1BBVEgnLmJvbGR9LmA7XG4gIH1cbn1cbmNoZWNrcy5wdXNoKG5ldyBBbmRyb2lkVG9vbENoZWNrKCdhZGInLFxuICBwYXRoLmpvaW4oJ3BsYXRmb3JtLXRvb2xzJywgc3lzdGVtLmlzV2luZG93cygpID8gJ2FkYi5leGUnIDogJ2FkYicpKSk7XG5jaGVja3MucHVzaChuZXcgQW5kcm9pZFRvb2xDaGVjaygnYW5kcm9pZCcsXG4gIHBhdGguam9pbigndG9vbHMnLCBzeXN0ZW0uaXNXaW5kb3dzKCkgPyAnYW5kcm9pZC5iYXQnIDogJ2FuZHJvaWQnKSkpO1xuY2hlY2tzLnB1c2gobmV3IEFuZHJvaWRUb29sQ2hlY2soJ2VtdWxhdG9yJyxcbiAgcGF0aC5qb2luKCd0b29scycsIHN5c3RlbS5pc1dpbmRvd3MoKSA/ICdlbXVsYXRvci5leGUnIDogJ2VtdWxhdG9yJykpKTtcbmNoZWNrcy5wdXNoKG5ldyBKYXZhT25QYXRoQ2hlY2soKSk7XG5cbmNsYXNzIE9wdGlvbmFsQXBwQnVuZGxlQ2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIGFzeW5jIGRpYWdub3NlICgpIHtcbiAgICBjb25zdCBidW5kbGV0b29sUGF0aCA9IGF3YWl0IHJlc29sdmVFeGVjdXRhYmxlUGF0aCgnYnVuZGxldG9vbC5qYXInKTtcbiAgICByZXR1cm4gYnVuZGxldG9vbFBhdGhcbiAgICAgID8gb2tPcHRpb25hbChgYnVuZGxldG9vbC5qYXIgaXMgaW5zdGFsbGVkIGF0OiAke2J1bmRsZXRvb2xQYXRofWApXG4gICAgICA6IG5va09wdGlvbmFsKCdidW5kbGV0b29sLmphciBjYW5ub3QgYmUgZm91bmQnKTtcbiAgfVxuXG4gIGFzeW5jIGZpeCAoKSB7IC8vIGVzbGludC1kaXNhYmxlLWxpbmUgcmVxdWlyZS1hd2FpdFxuICAgIHJldHVybiBgJHsnYnVuZGxldG9vbC5qYXInLmJvbGR9IGlzIHVzZWQgdG8gaGFuZGxlIEFuZHJvaWQgQXBwIEJ1bmRsZS4gUGxlYXNlIHJlYWQgaHR0cDovL2FwcGl1bS5pby9kb2NzL2VuL3dyaXRpbmctcnVubmluZy1hcHBpdW0vYW5kcm9pZC9hbmRyb2lkLWFwcGJ1bmRsZS8gdG8gaW5zdGFsbCBpdGAgK1xuICAgICAgYCR7c3lzdGVtLmlzV2luZG93cygpID8gJy4gQWxzbyBjb25zaWRlciBhZGRpbmcgdGhlIFwiLmphclwiIGV4dGVuc2lvbiBpbnRvIHlvdXIgUEFUSEVYVCBlbnZpcm9ubWVudCB2YXJpYWJsZSBpbiBvcmRlciB0byBmaXggdGhlIHByb2JsZW0gZm9yIFdpbmRvd3MnIDogJyd9YDtcbiAgfVxufVxuY2hlY2tzLnB1c2gobmV3IE9wdGlvbmFsQXBwQnVuZGxlQ2hlY2soKSk7XG5cbmNsYXNzIE9wdGlvbmFsR3N0cmVhbWVyQ2hlY2sgZXh0ZW5kcyBEb2N0b3JDaGVjayB7XG4gIEdTVFJFQU1FUl9CSU5BUlkgPSBgZ3N0LWxhdW5jaC0xLjAke3N5c3RlbS5pc1dpbmRvd3MoKSA/ICcuZXhlJyA6ICcnfWA7XG4gIEdTVF9JTlNQRUNUX0JJTkFSWSA9IGBnc3QtaW5zcGVjdC0xLjAke3N5c3RlbS5pc1dpbmRvd3MoKSA/ICcuZXhlJyA6ICcnfWA7XG5cbiAgYXN5bmMgZGlhZ25vc2UgKCkge1xuICAgIGNvbnN0IGdzdHJlYW1lclBhdGggPSBhd2FpdCByZXNvbHZlRXhlY3V0YWJsZVBhdGgodGhpcy5HU1RSRUFNRVJfQklOQVJZKTtcbiAgICBjb25zdCBnc3RJbnNwZWN0UGF0aCA9IGF3YWl0IHJlc29sdmVFeGVjdXRhYmxlUGF0aCh0aGlzLkdTVF9JTlNQRUNUX0JJTkFSWSk7XG5cbiAgICByZXR1cm4gZ3N0cmVhbWVyUGF0aCAmJiBnc3RJbnNwZWN0UGF0aFxuICAgICAgPyBva09wdGlvbmFsKGAke3RoaXMuR1NUUkVBTUVSX0JJTkFSWX0gYW5kICR7dGhpcy5HU1RfSU5TUEVDVF9CSU5BUll9IGFyZSBpbnN0YWxsZWQgYXQ6ICR7Z3N0cmVhbWVyUGF0aH0gYW5kICR7Z3N0SW5zcGVjdFBhdGh9YClcbiAgICAgIDogbm9rT3B0aW9uYWwoYCR7dGhpcy5HU1RSRUFNRVJfQklOQVJZfSBhbmQvb3IgJHt0aGlzLkdTVF9JTlNQRUNUX0JJTkFSWX0gY2Fubm90IGJlIGZvdW5kYCk7XG4gIH1cblxuICBhc3luYyBmaXggKCkgeyAvLyBlc2xpbnQtZGlzYWJsZS1saW5lIHJlcXVpcmUtYXdhaXRcbiAgICByZXR1cm4gYCR7YCR7dGhpcy5HU1RSRUFNRVJfQklOQVJZfSBhbmQgJHt0aGlzLkdTVF9JTlNQRUNUX0JJTkFSWX1gLmJvbGR9IGFyZSB1c2VkIHRvIHN0cmVhbSB0aGUgc2NyZWVuIG9mIHRoZSBkZXZpY2UgdW5kZXIgdGVzdC4gYCArXG4gICAgICAnUGxlYXNlIHJlYWQgaHR0cHM6Ly9hcHBpdW0uaW8vZG9jcy9lbi93cml0aW5nLXJ1bm5pbmctYXBwaXVtL2FuZHJvaWQvYW5kcm9pZC1zY3JlZW4tc3RyZWFtaW5nLyB0byBpbnN0YWxsIHRoZW0gYW5kIGZvciBtb3JlIGRldGFpbHMnO1xuICB9XG59XG5jaGVja3MucHVzaChuZXcgT3B0aW9uYWxHc3RyZWFtZXJDaGVjaygpKTtcblxuZXhwb3J0IHsgRW52VmFyQW5kUGF0aENoZWNrLCBBbmRyb2lkVG9vbENoZWNrLCBKYXZhT25QYXRoQ2hlY2ssIE9wdGlvbmFsQXBwQnVuZGxlQ2hlY2ssIE9wdGlvbmFsR3N0cmVhbWVyQ2hlY2sgfTtcbmV4cG9ydCBkZWZhdWx0IGNoZWNrcztcbiJdLCJmaWxlIjoibGliL2FuZHJvaWQuanMiLCJzb3VyY2VSb290IjoiLi4vLi4ifQ==
