"use strict";

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

require("source-map-support/register");

var _lodash = _interopRequireDefault(require("lodash"));

var _chai = _interopRequireDefault(require("chai"));

var _chaiAsPromised = _interopRequireDefault(require("chai-as-promised"));

var _2 = _interopRequireWildcard(require("../.."));

var _imageElement = require("../../lib/basedriver/image-element");

var _protocol = require("../../lib/protocol/protocol");

var _sinon = _interopRequireDefault(require("sinon"));

_chai.default.should();

_chai.default.use(_chaiAsPromised.default);

const defRect = {
  x: 100,
  y: 110,
  width: 50,
  height: 25
};
const defTemplate = 'iVBORasdf';
describe('ImageElement', function () {
  const driver = new _2.default();
  describe('.size', function () {
    it('should return the width and height of the image el', function () {
      const el = new _2.ImageElement(defTemplate, defRect);
      el.size.should.eql({
        width: defRect.width,
        height: defRect.height
      });
    });
  });
  describe('.location', function () {
    it('should return the location of the image el', function () {
      const el = new _2.ImageElement(defTemplate, defRect);
      el.location.should.eql({
        x: defRect.x,
        y: defRect.y
      });
    });
  });
  describe('.center', function () {
    it('should return the center location of the image el', function () {
      const el = new _2.ImageElement(defTemplate, defRect);
      el.center.should.eql({
        x: defRect.x + defRect.width / 2,
        y: defRect.y + defRect.height / 2
      });
    });
  });
  describe('.asElement', function () {
    it('should get the webdriver object representation of the element', function () {
      const el = new _2.ImageElement(defTemplate, defRect);
      el.asElement('ELEMENT').ELEMENT.should.match(/^appium-image-el/);
    });
  });
  describe('.equals', function () {
    it('should say two image elements with same rect are equal', function () {
      const el1 = new _2.ImageElement('foo', defRect);
      const el2 = new _2.ImageElement('bar', defRect);
      el1.equals(el2).should.be.true;
      el2.equals(el1).should.be.true;
    });
    it('should say two image elements with different rect are not equal', function () {
      const el1 = new _2.ImageElement(defTemplate, { ...defRect,
        x: 0
      });
      const el2 = new _2.ImageElement(defTemplate, defRect);
      el1.equals(el2).should.be.false;
      el2.equals(el1).should.be.false;
    });
  });
  describe('.click', function () {
    it('should reject an invalid tap strategy', async function () {
      const d = new _2.default();
      const el = new _2.ImageElement(defTemplate, defRect);
      await d.settings.update({
        imageElementTapStrategy: 'bad'
      });
      await el.click(d).should.eventually.be.rejectedWith(/Incorrect imageElementTapStrategy/);
    });
    it('should try to check for image element staleness, and throw if stale', async function () {
      const d = new _2.default();

      _sinon.default.stub(d, 'findByImage').throws();

      const el = new _2.ImageElement(defTemplate, defRect);
      await d.settings.update({
        checkForImageElementStaleness: true,
        autoUpdateImageElementPosition: false
      });
      await el.click(d).should.eventually.be.rejectedWith(/no longer attached/);
      await d.settings.update({
        checkForImageElementStaleness: false,
        autoUpdateImageElementPosition: true
      });
      await el.click(d).should.eventually.be.rejectedWith(/no longer attached/);
    });
    it('should auto-update element position if requested', async function () {
      const d = new _2.default();
      d.performActions = _lodash.default.noop;

      _sinon.default.stub(d, 'performActions');

      const el = new _2.ImageElement(defTemplate, defRect);
      const newRect = { ...defRect,
        x: defRect.x + 10,
        y: defRect.y + 5
      };
      const elPos2 = new _2.ImageElement(defTemplate, newRect);

      _sinon.default.stub(d, 'findByImage').returns(elPos2);

      await d.settings.update({
        autoUpdateImageElementPosition: true
      });
      el.rect.should.not.eql(newRect);
      await el.click(d);
      el.rect.should.eql(newRect);
    });
    it('should tap the center of an element using w3c actions by default', async function () {
      const d = new _2.default();
      d.performActions = _lodash.default.noop;

      const actionStub = _sinon.default.stub(d, 'performActions');

      const el = new _2.ImageElement(defTemplate, defRect);
      await d.settings.update({
        checkForImageElementStaleness: false
      });
      await el.click(d);
      const pointerMoveAction = actionStub.args[0][0][0].actions[0];
      pointerMoveAction.x.should.equal(el.center.x);
      pointerMoveAction.y.should.equal(el.center.y);
    });
    it('should fall back to touchactions if w3c actions do not exist on driver', async function () {
      const d = new _2.default();
      d.performTouch = _lodash.default.noop;

      const actionStub = _sinon.default.stub(d, 'performTouch');

      const el = new _2.ImageElement(defTemplate, defRect);
      await d.settings.update({
        checkForImageElementStaleness: false
      });
      await el.click(d);
      const action = actionStub.args[0][0][0].options;
      action.x.should.equal(el.center.x);
      action.y.should.equal(el.center.y);
    });
    it('should use touchactions if requested', async function () {
      const d = new _2.default();
      d.performActions = _lodash.default.noop;

      const w3cStub = _sinon.default.stub(d, 'performActions');

      d.performTouch = _lodash.default.noop;

      const touchStub = _sinon.default.stub(d, 'performTouch');

      const el = new _2.ImageElement(defTemplate, defRect);
      await d.settings.update({
        checkForImageElementStaleness: false,
        imageElementTapStrategy: 'touchActions'
      });
      await el.click(d);
      const action = touchStub.args[0][0][0].options;
      action.x.should.equal(el.center.x);
      action.y.should.equal(el.center.y);
      w3cStub.callCount.should.eql(0);
    });
    it('should throw if driver does not implement any type of action', async function () {
      const d = new _2.default();
      const el = new _2.ImageElement(defTemplate, defRect);
      await d.settings.update({
        checkForImageElementStaleness: false
      });
      await el.click(d).should.eventually.be.rejectedWith(/did not implement/);
    });
  });
  describe('#execute', function () {
    const imgEl = new _2.ImageElement(defTemplate, defRect, 0, 'aGFwcHkgdGVzdGluZw==');

    const clickStub = _sinon.default.stub(imgEl, 'click');

    before(function () {
      driver._imgElCache.set(imgEl.id, imgEl);

      clickStub.returns(true);
    });
    after(function () {
      driver._imgElCache.reset();

      clickStub.restore();
    });
    it('should reject executions on elements not in the cache', async function () {
      await _2.ImageElement.execute(driver, 'click', 'appium-image-element-foo').should.eventually.be.rejectedWith(/element could not be located/);
    });
    it('should reject executions for unsupported commands', async function () {
      await _2.ImageElement.execute(driver, 'foobar', imgEl.id).should.eventually.be.rejectedWith(/not yet been implemented/);
    });
    it('should get displayed status of element', async function () {
      await _2.ImageElement.execute(driver, 'elementDisplayed', imgEl.id).should.eventually.be.true;
    });
    it('should get size of element', async function () {
      await _2.ImageElement.execute(driver, 'getSize', imgEl.id).should.eventually.eql({
        width: defRect.width,
        height: defRect.height
      });
    });
    it('should get location of element', async function () {
      await _2.ImageElement.execute(driver, 'getLocation', imgEl.id).should.eventually.eql({
        x: defRect.x,
        y: defRect.y
      });
    });
    it('should get location in view of element', async function () {
      await _2.ImageElement.execute(driver, 'getLocation', imgEl.id).should.eventually.eql({
        x: defRect.x,
        y: defRect.y
      });
    });
    it('should get rect of element', async function () {
      await _2.ImageElement.execute(driver, 'getElementRect', imgEl.id).should.eventually.eql(defRect);
    });
    it('should get score of element', async function () {
      await _2.ImageElement.execute(driver, 'getAttribute', imgEl.id, 'score').should.eventually.eql(0);
    });
    it('should get visual of element', async function () {
      await _2.ImageElement.execute(driver, 'getAttribute', imgEl.id, 'visual').should.eventually.eql('aGFwcHkgdGVzdGluZw==');
    });
    it('should get null as visual of element by default', async function () {
      const imgElement = new _2.ImageElement(defTemplate, defRect);

      driver._imgElCache.set(imgElement.id, imgElement);

      await _2.ImageElement.execute(driver, 'getAttribute', imgElement.id, 'visual').should.eventually.eql(null);
    });
    it('should not get other attribute', async function () {
      await _2.ImageElement.execute(driver, 'getAttribute', imgEl.id, 'content-desc').should.eventually.rejectedWith('Method has not yet been implemented');
    });
    it('should click element', async function () {
      await _2.ImageElement.execute(driver, 'click', imgEl.id).should.eventually.be.true;
    });
  });
});
describe('image element LRU cache', function () {
  it('should accept and cache image elements', function () {
    const el1 = new _2.ImageElement(defTemplate, defRect);
    const el2 = new _2.ImageElement(defTemplate, defRect);
    const cache = (0, _imageElement.makeImageElementCache)();
    cache.set(el1.id, el1);
    el1.equals(cache.get(el1.id)).should.be.true;
    _lodash.default.isUndefined(cache.get(el2.id)).should.be.true;
    cache.has(el1.id).should.be.true;
    cache.has(el2.id).should.be.false;
  });
  it('once cache reaches max size, should eject image elements', function () {
    const el1 = new _2.ImageElement(defTemplate, defRect);
    const el2 = new _2.ImageElement(defTemplate, defRect);
    const cache = (0, _imageElement.makeImageElementCache)(defTemplate.length + 1);
    cache.set(el1.id, el1);
    cache.has(el1.id).should.be.true;
    cache.set(el2.id, el2);
    cache.has(el2.id).should.be.true;
    cache.has(el1.id).should.be.false;
  });
});
describe('getImgElFromArgs', function () {
  it('should return the image element id from json obj in args', function () {
    const imgEl = `${_protocol.IMAGE_ELEMENT_PREFIX}foo`;
    const args = [1, 'foo', imgEl];
    (0, _imageElement.getImgElFromArgs)(args).should.eql(imgEl);
  });
  it('should not return anything if image element id not in args', function () {
    const args = [1, 'foo'];
    _lodash.default.isUndefined((0, _imageElement.getImgElFromArgs)(args)).should.be.true;
  });
  it('should not find image element id in anything but prefix', function () {
    const notImgEl = `foo${_protocol.IMAGE_ELEMENT_PREFIX}`;
    const args = [1, 'foo', notImgEl];
    _lodash.default.isUndefined((0, _imageElement.getImgElFromArgs)(args)).should.be.true;
  });
});require('source-map-support').install();


//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRlc3QvYmFzZWRyaXZlci9pbWFnZS1lbGVtZW50LXNwZWNzLmpzIl0sIm5hbWVzIjpbImNoYWkiLCJzaG91bGQiLCJ1c2UiLCJjaGFpQXNQcm9taXNlZCIsImRlZlJlY3QiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0IiwiZGVmVGVtcGxhdGUiLCJkZXNjcmliZSIsImRyaXZlciIsIkJhc2VEcml2ZXIiLCJpdCIsImVsIiwiSW1hZ2VFbGVtZW50Iiwic2l6ZSIsImVxbCIsImxvY2F0aW9uIiwiY2VudGVyIiwiYXNFbGVtZW50IiwiRUxFTUVOVCIsIm1hdGNoIiwiZWwxIiwiZWwyIiwiZXF1YWxzIiwiYmUiLCJ0cnVlIiwiZmFsc2UiLCJkIiwic2V0dGluZ3MiLCJ1cGRhdGUiLCJpbWFnZUVsZW1lbnRUYXBTdHJhdGVneSIsImNsaWNrIiwiZXZlbnR1YWxseSIsInJlamVjdGVkV2l0aCIsInNpbm9uIiwic3R1YiIsInRocm93cyIsImNoZWNrRm9ySW1hZ2VFbGVtZW50U3RhbGVuZXNzIiwiYXV0b1VwZGF0ZUltYWdlRWxlbWVudFBvc2l0aW9uIiwicGVyZm9ybUFjdGlvbnMiLCJfIiwibm9vcCIsIm5ld1JlY3QiLCJlbFBvczIiLCJyZXR1cm5zIiwicmVjdCIsIm5vdCIsImFjdGlvblN0dWIiLCJwb2ludGVyTW92ZUFjdGlvbiIsImFyZ3MiLCJhY3Rpb25zIiwiZXF1YWwiLCJwZXJmb3JtVG91Y2giLCJhY3Rpb24iLCJvcHRpb25zIiwidzNjU3R1YiIsInRvdWNoU3R1YiIsImNhbGxDb3VudCIsImltZ0VsIiwiY2xpY2tTdHViIiwiYmVmb3JlIiwiX2ltZ0VsQ2FjaGUiLCJzZXQiLCJpZCIsImFmdGVyIiwicmVzZXQiLCJyZXN0b3JlIiwiZXhlY3V0ZSIsImltZ0VsZW1lbnQiLCJjYWNoZSIsImdldCIsImlzVW5kZWZpbmVkIiwiaGFzIiwibGVuZ3RoIiwiSU1BR0VfRUxFTUVOVF9QUkVGSVgiLCJub3RJbWdFbCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFB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QWxDO0FBQ0QsR0FKQyxDQUFGO0FBS0EvQyxFQUFBQSxFQUFFLENBQUMsNERBQUQsRUFBK0QsWUFBWTtBQUMzRSxVQUFNc0MsSUFBSSxHQUFHLENBQUMsQ0FBRCxFQUFJLEtBQUosQ0FBYjtBQUNBVCxvQkFBRStCLFdBQUYsQ0FBYyxvQ0FBaUJ0QixJQUFqQixDQUFkLEVBQXNDbEQsTUFBdEMsQ0FBNkN5QixFQUE3QyxDQUFnREMsSUFBaEQ7QUFDRCxHQUhDLENBQUY7QUFJQWQsRUFBQUEsRUFBRSxDQUFDLHlEQUFELEVBQTRELFlBQVk7QUFDeEUsVUFBTWdFLFFBQVEsR0FBSSxNQUFLRCw4QkFBcUIsRUFBNUM7QUFDQSxVQUFNekIsSUFBSSxHQUFHLENBQUMsQ0FBRCxFQUFJLEtBQUosRUFBVzBCLFFBQVgsQ0FBYjtBQUNBbkMsb0JBQUUrQixXQUFGLENBQWMsb0NBQWlCdEIsSUFBakIsQ0FBZCxFQUFzQ2xELE1BQXRDLENBQTZDeUIsRUFBN0MsQ0FBZ0RDLElBQWhEO0FBQ0QsR0FKQyxDQUFGO0FBS0QsQ0FmTyxDQUFSIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcbmltcG9ydCBjaGFpIGZyb20gJ2NoYWknO1xuaW1wb3J0IGNoYWlBc1Byb21pc2VkIGZyb20gJ2NoYWktYXMtcHJvbWlzZWQnO1xuaW1wb3J0IEJhc2VEcml2ZXIsIHsgSW1hZ2VFbGVtZW50IH0gZnJvbSAnLi4vLi4nO1xuaW1wb3J0IHsgbWFrZUltYWdlRWxlbWVudENhY2hlLCBnZXRJbWdFbEZyb21BcmdzIH0gZnJvbSAnLi4vLi4vbGliL2Jhc2Vkcml2ZXIvaW1hZ2UtZWxlbWVudCc7XG5pbXBvcnQgeyBJTUFHRV9FTEVNRU5UX1BSRUZJWCB9IGZyb20gJy4uLy4uL2xpYi9wcm90b2NvbC9wcm90b2NvbCc7XG5pbXBvcnQgc2lub24gZnJvbSAnc2lub24nO1xuXG5cbmNoYWkuc2hvdWxkKCk7XG5jaGFpLnVzZShjaGFpQXNQcm9taXNlZCk7XG5cblxuY29uc3QgZGVmUmVjdCA9IHt4OiAxMDAsIHk6IDExMCwgd2lkdGg6IDUwLCBoZWlnaHQ6IDI1fTtcbmNvbnN0IGRlZlRlbXBsYXRlID0gJ2lWQk9SYXNkZic7XG5cbmRlc2NyaWJlKCdJbWFnZUVsZW1lbnQnLCBmdW5jdGlvbiAoKSB7XG4gIGNvbnN0IGRyaXZlciA9IG5ldyBCYXNlRHJpdmVyKCk7XG5cbiAgZGVzY3JpYmUoJy5zaXplJywgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgcmV0dXJuIHRoZSB3aWR0aCBhbmQgaGVpZ2h0IG9mIHRoZSBpbWFnZSBlbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGVsID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgICBlbC5zaXplLnNob3VsZC5lcWwoe3dpZHRoOiBkZWZSZWN0LndpZHRoLCBoZWlnaHQ6IGRlZlJlY3QuaGVpZ2h0fSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCcubG9jYXRpb24nLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZXR1cm4gdGhlIGxvY2F0aW9uIG9mIHRoZSBpbWFnZSBlbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGVsID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgICBlbC5sb2NhdGlvbi5zaG91bGQuZXFsKHt4OiBkZWZSZWN0LngsIHk6IGRlZlJlY3QueX0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnLmNlbnRlcicsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0aGUgY2VudGVyIGxvY2F0aW9uIG9mIHRoZSBpbWFnZSBlbCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGVsID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgICBlbC5jZW50ZXIuc2hvdWxkLmVxbCh7XG4gICAgICAgIHg6IGRlZlJlY3QueCArIGRlZlJlY3Qud2lkdGggLyAyLFxuICAgICAgICB5OiBkZWZSZWN0LnkgKyBkZWZSZWN0LmhlaWdodCAvIDJcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnLmFzRWxlbWVudCcsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGdldCB0aGUgd2ViZHJpdmVyIG9iamVjdCByZXByZXNlbnRhdGlvbiBvZiB0aGUgZWxlbWVudCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGNvbnN0IGVsID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgICBlbC5hc0VsZW1lbnQoJ0VMRU1FTlQnKS5FTEVNRU5ULnNob3VsZC5tYXRjaCgvXmFwcGl1bS1pbWFnZS1lbC8pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZSgnLmVxdWFscycsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIHNheSB0d28gaW1hZ2UgZWxlbWVudHMgd2l0aCBzYW1lIHJlY3QgYXJlIGVxdWFsJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZWwxID0gbmV3IEltYWdlRWxlbWVudCgnZm9vJywgZGVmUmVjdCk7XG4gICAgICBjb25zdCBlbDIgPSBuZXcgSW1hZ2VFbGVtZW50KCdiYXInLCBkZWZSZWN0KTtcbiAgICAgIGVsMS5lcXVhbHMoZWwyKS5zaG91bGQuYmUudHJ1ZTtcbiAgICAgIGVsMi5lcXVhbHMoZWwxKS5zaG91bGQuYmUudHJ1ZTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHNheSB0d28gaW1hZ2UgZWxlbWVudHMgd2l0aCBkaWZmZXJlbnQgcmVjdCBhcmUgbm90IGVxdWFsJywgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZWwxID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgey4uLmRlZlJlY3QsIHg6IDB9KTtcbiAgICAgIGNvbnN0IGVsMiA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgICAgZWwxLmVxdWFscyhlbDIpLnNob3VsZC5iZS5mYWxzZTtcbiAgICAgIGVsMi5lcXVhbHMoZWwxKS5zaG91bGQuYmUuZmFsc2U7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCcuY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCByZWplY3QgYW4gaW52YWxpZCB0YXAgc3RyYXRlZ3knLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IEJhc2VEcml2ZXIoKTtcbiAgICAgIGNvbnN0IGVsID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgICBhd2FpdCBkLnNldHRpbmdzLnVwZGF0ZSh7aW1hZ2VFbGVtZW50VGFwU3RyYXRlZ3k6ICdiYWQnfSk7XG4gICAgICBhd2FpdCBlbC5jbGljayhkKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL0luY29ycmVjdCBpbWFnZUVsZW1lbnRUYXBTdHJhdGVneS8pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdHJ5IHRvIGNoZWNrIGZvciBpbWFnZSBlbGVtZW50IHN0YWxlbmVzcywgYW5kIHRocm93IGlmIHN0YWxlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgICBzaW5vbi5zdHViKGQsICdmaW5kQnlJbWFnZScpLnRocm93cygpO1xuICAgICAgY29uc3QgZWwgPSBuZXcgSW1hZ2VFbGVtZW50KGRlZlRlbXBsYXRlLCBkZWZSZWN0KTtcbiAgICAgIC8vIHdlIG5lZWQgdG8gY2hlY2sgZm9yIHN0YWxlbmVzcyBpZiBleHBsaWNpdGx5IHJlcXVlc3RlZCB0byBkbyBzb1xuICAgICAgYXdhaXQgZC5zZXR0aW5ncy51cGRhdGUoe1xuICAgICAgICBjaGVja0ZvckltYWdlRWxlbWVudFN0YWxlbmVzczogdHJ1ZSxcbiAgICAgICAgYXV0b1VwZGF0ZUltYWdlRWxlbWVudFBvc2l0aW9uOiBmYWxzZVxuICAgICAgfSk7XG4gICAgICBhd2FpdCBlbC5jbGljayhkKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL25vIGxvbmdlciBhdHRhY2hlZC8pO1xuXG4gICAgICAvLyBhbmQgYWxzbyBpZiB3ZSBhcmUgdXBkYXRpbmcgdGhlIGVsZW1lbnQgcG9zaXRpb25cbiAgICAgIGF3YWl0IGQuc2V0dGluZ3MudXBkYXRlKHtcbiAgICAgICAgY2hlY2tGb3JJbWFnZUVsZW1lbnRTdGFsZW5lc3M6IGZhbHNlLFxuICAgICAgICBhdXRvVXBkYXRlSW1hZ2VFbGVtZW50UG9zaXRpb246IHRydWVcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgZWwuY2xpY2soZCkuc2hvdWxkLmV2ZW50dWFsbHkuYmUucmVqZWN0ZWRXaXRoKC9ubyBsb25nZXIgYXR0YWNoZWQvKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGF1dG8tdXBkYXRlIGVsZW1lbnQgcG9zaXRpb24gaWYgcmVxdWVzdGVkJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgICBkLnBlcmZvcm1BY3Rpb25zID0gXy5ub29wO1xuICAgICAgc2lub24uc3R1YihkLCAncGVyZm9ybUFjdGlvbnMnKTtcbiAgICAgIGNvbnN0IGVsID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgICBjb25zdCBuZXdSZWN0ID0gey4uLmRlZlJlY3QsIHg6IGRlZlJlY3QueCArIDEwLCB5OiBkZWZSZWN0LnkgKyA1fTtcbiAgICAgIGNvbnN0IGVsUG9zMiA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIG5ld1JlY3QpO1xuICAgICAgc2lub24uc3R1YihkLCAnZmluZEJ5SW1hZ2UnKS5yZXR1cm5zKGVsUG9zMik7XG4gICAgICBhd2FpdCBkLnNldHRpbmdzLnVwZGF0ZSh7XG4gICAgICAgIGF1dG9VcGRhdGVJbWFnZUVsZW1lbnRQb3NpdGlvbjogdHJ1ZSxcbiAgICAgIH0pO1xuICAgICAgZWwucmVjdC5zaG91bGQubm90LmVxbChuZXdSZWN0KTtcbiAgICAgIGF3YWl0IGVsLmNsaWNrKGQpO1xuICAgICAgZWwucmVjdC5zaG91bGQuZXFsKG5ld1JlY3QpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdGFwIHRoZSBjZW50ZXIgb2YgYW4gZWxlbWVudCB1c2luZyB3M2MgYWN0aW9ucyBieSBkZWZhdWx0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgICBkLnBlcmZvcm1BY3Rpb25zID0gXy5ub29wO1xuICAgICAgY29uc3QgYWN0aW9uU3R1YiA9IHNpbm9uLnN0dWIoZCwgJ3BlcmZvcm1BY3Rpb25zJyk7XG4gICAgICBjb25zdCBlbCA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgICAgLy8gc2tpcCB0aGUgc3RhbGVuZXNzIGNoZWNrIGZvciB0aGlzIHRlc3RcbiAgICAgIGF3YWl0IGQuc2V0dGluZ3MudXBkYXRlKHtcbiAgICAgICAgY2hlY2tGb3JJbWFnZUVsZW1lbnRTdGFsZW5lc3M6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgICBhd2FpdCBlbC5jbGljayhkKTtcbiAgICAgIGNvbnN0IHBvaW50ZXJNb3ZlQWN0aW9uID0gYWN0aW9uU3R1Yi5hcmdzWzBdWzBdWzBdLmFjdGlvbnNbMF07XG4gICAgICBwb2ludGVyTW92ZUFjdGlvbi54LnNob3VsZC5lcXVhbChlbC5jZW50ZXIueCk7XG4gICAgICBwb2ludGVyTW92ZUFjdGlvbi55LnNob3VsZC5lcXVhbChlbC5jZW50ZXIueSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBmYWxsIGJhY2sgdG8gdG91Y2hhY3Rpb25zIGlmIHczYyBhY3Rpb25zIGRvIG5vdCBleGlzdCBvbiBkcml2ZXInLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IEJhc2VEcml2ZXIoKTtcbiAgICAgIGQucGVyZm9ybVRvdWNoID0gXy5ub29wO1xuICAgICAgY29uc3QgYWN0aW9uU3R1YiA9IHNpbm9uLnN0dWIoZCwgJ3BlcmZvcm1Ub3VjaCcpO1xuICAgICAgY29uc3QgZWwgPSBuZXcgSW1hZ2VFbGVtZW50KGRlZlRlbXBsYXRlLCBkZWZSZWN0KTtcbiAgICAgIC8vIHNraXAgdGhlIHN0YWxlbmVzcyBjaGVjayBmb3IgdGhpcyB0ZXN0XG4gICAgICBhd2FpdCBkLnNldHRpbmdzLnVwZGF0ZSh7XG4gICAgICAgIGNoZWNrRm9ySW1hZ2VFbGVtZW50U3RhbGVuZXNzOiBmYWxzZSxcbiAgICAgIH0pO1xuICAgICAgYXdhaXQgZWwuY2xpY2soZCk7XG4gICAgICBjb25zdCBhY3Rpb24gPSBhY3Rpb25TdHViLmFyZ3NbMF1bMF1bMF0ub3B0aW9ucztcbiAgICAgIGFjdGlvbi54LnNob3VsZC5lcXVhbChlbC5jZW50ZXIueCk7XG4gICAgICBhY3Rpb24ueS5zaG91bGQuZXF1YWwoZWwuY2VudGVyLnkpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgdXNlIHRvdWNoYWN0aW9ucyBpZiByZXF1ZXN0ZWQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBjb25zdCBkID0gbmV3IEJhc2VEcml2ZXIoKTtcbiAgICAgIGQucGVyZm9ybUFjdGlvbnMgPSBfLm5vb3A7XG4gICAgICBjb25zdCB3M2NTdHViID0gc2lub24uc3R1YihkLCAncGVyZm9ybUFjdGlvbnMnKTtcbiAgICAgIGQucGVyZm9ybVRvdWNoID0gXy5ub29wO1xuICAgICAgY29uc3QgdG91Y2hTdHViID0gc2lub24uc3R1YihkLCAncGVyZm9ybVRvdWNoJyk7XG4gICAgICBjb25zdCBlbCA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgICAgLy8gc2tpcCB0aGUgc3RhbGVuZXNzIGNoZWNrIGZvciB0aGlzIHRlc3RcbiAgICAgIGF3YWl0IGQuc2V0dGluZ3MudXBkYXRlKHtcbiAgICAgICAgY2hlY2tGb3JJbWFnZUVsZW1lbnRTdGFsZW5lc3M6IGZhbHNlLFxuICAgICAgICBpbWFnZUVsZW1lbnRUYXBTdHJhdGVneTogJ3RvdWNoQWN0aW9ucycsXG4gICAgICB9KTtcbiAgICAgIGF3YWl0IGVsLmNsaWNrKGQpO1xuICAgICAgY29uc3QgYWN0aW9uID0gdG91Y2hTdHViLmFyZ3NbMF1bMF1bMF0ub3B0aW9ucztcbiAgICAgIGFjdGlvbi54LnNob3VsZC5lcXVhbChlbC5jZW50ZXIueCk7XG4gICAgICBhY3Rpb24ueS5zaG91bGQuZXF1YWwoZWwuY2VudGVyLnkpO1xuICAgICAgdzNjU3R1Yi5jYWxsQ291bnQuc2hvdWxkLmVxbCgwKTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIHRocm93IGlmIGRyaXZlciBkb2VzIG5vdCBpbXBsZW1lbnQgYW55IHR5cGUgb2YgYWN0aW9uJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgZCA9IG5ldyBCYXNlRHJpdmVyKCk7XG4gICAgICBjb25zdCBlbCA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgICAgLy8gc2tpcCB0aGUgc3RhbGVuZXNzIGNoZWNrIGZvciB0aGlzIHRlc3RcbiAgICAgIGF3YWl0IGQuc2V0dGluZ3MudXBkYXRlKHtcbiAgICAgICAgY2hlY2tGb3JJbWFnZUVsZW1lbnRTdGFsZW5lc3M6IGZhbHNlLFxuICAgICAgfSk7XG4gICAgICBhd2FpdCBlbC5jbGljayhkKS5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL2RpZCBub3QgaW1wbGVtZW50Lyk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKCcjZXhlY3V0ZScsIGZ1bmN0aW9uICgpIHtcbiAgICAvLyBhR0Z3Y0hrZ2RHVnpkR2x1Wnc9PSBpcyAnaGFwcHkgdGVzdGluZydcbiAgICBjb25zdCBpbWdFbCA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QsIDAsICdhR0Z3Y0hrZ2RHVnpkR2x1Wnc9PScpO1xuICAgIGNvbnN0IGNsaWNrU3R1YiA9IHNpbm9uLnN0dWIoaW1nRWwsICdjbGljaycpO1xuXG4gICAgYmVmb3JlKGZ1bmN0aW9uICgpIHtcbiAgICAgIGRyaXZlci5faW1nRWxDYWNoZS5zZXQoaW1nRWwuaWQsIGltZ0VsKTtcbiAgICAgIGNsaWNrU3R1Yi5yZXR1cm5zKHRydWUpO1xuICAgIH0pO1xuXG4gICAgYWZ0ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgZHJpdmVyLl9pbWdFbENhY2hlLnJlc2V0KCk7XG4gICAgICBjbGlja1N0dWIucmVzdG9yZSgpO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCByZWplY3QgZXhlY3V0aW9ucyBvbiBlbGVtZW50cyBub3QgaW4gdGhlIGNhY2hlJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgSW1hZ2VFbGVtZW50LmV4ZWN1dGUoZHJpdmVyLCAnY2xpY2snLCAnYXBwaXVtLWltYWdlLWVsZW1lbnQtZm9vJylcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmJlLnJlamVjdGVkV2l0aCgvZWxlbWVudCBjb3VsZCBub3QgYmUgbG9jYXRlZC8pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgcmVqZWN0IGV4ZWN1dGlvbnMgZm9yIHVuc3VwcG9ydGVkIGNvbW1hbmRzJywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgSW1hZ2VFbGVtZW50LmV4ZWN1dGUoZHJpdmVyLCAnZm9vYmFyJywgaW1nRWwuaWQpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5iZS5yZWplY3RlZFdpdGgoL25vdCB5ZXQgYmVlbiBpbXBsZW1lbnRlZC8pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZ2V0IGRpc3BsYXllZCBzdGF0dXMgb2YgZWxlbWVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IEltYWdlRWxlbWVudC5leGVjdXRlKGRyaXZlciwgJ2VsZW1lbnREaXNwbGF5ZWQnLCBpbWdFbC5pZClcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmJlLnRydWU7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBnZXQgc2l6ZSBvZiBlbGVtZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgSW1hZ2VFbGVtZW50LmV4ZWN1dGUoZHJpdmVyLCAnZ2V0U2l6ZScsIGltZ0VsLmlkKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuZXFsKHt3aWR0aDogZGVmUmVjdC53aWR0aCwgaGVpZ2h0OiBkZWZSZWN0LmhlaWdodH0pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZ2V0IGxvY2F0aW9uIG9mIGVsZW1lbnQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBJbWFnZUVsZW1lbnQuZXhlY3V0ZShkcml2ZXIsICdnZXRMb2NhdGlvbicsIGltZ0VsLmlkKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuZXFsKHt4OiBkZWZSZWN0LngsIHk6IGRlZlJlY3QueX0pO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgZ2V0IGxvY2F0aW9uIGluIHZpZXcgb2YgZWxlbWVudCcsIGFzeW5jIGZ1bmN0aW9uICgpIHtcbiAgICAgIGF3YWl0IEltYWdlRWxlbWVudC5leGVjdXRlKGRyaXZlciwgJ2dldExvY2F0aW9uJywgaW1nRWwuaWQpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5lcWwoe3g6IGRlZlJlY3QueCwgeTogZGVmUmVjdC55fSk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBnZXQgcmVjdCBvZiBlbGVtZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgSW1hZ2VFbGVtZW50LmV4ZWN1dGUoZHJpdmVyLCAnZ2V0RWxlbWVudFJlY3QnLCBpbWdFbC5pZClcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmVxbChkZWZSZWN0KTtcbiAgICB9KTtcbiAgICBpdCgnc2hvdWxkIGdldCBzY29yZSBvZiBlbGVtZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgSW1hZ2VFbGVtZW50LmV4ZWN1dGUoZHJpdmVyLCAnZ2V0QXR0cmlidXRlJywgaW1nRWwuaWQsICdzY29yZScpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5lcWwoMCk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBnZXQgdmlzdWFsIG9mIGVsZW1lbnQnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBJbWFnZUVsZW1lbnQuZXhlY3V0ZShkcml2ZXIsICdnZXRBdHRyaWJ1dGUnLCBpbWdFbC5pZCwgJ3Zpc3VhbCcpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5lcWwoJ2FHRndjSGtnZEdWemRHbHVadz09Jyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBnZXQgbnVsbCBhcyB2aXN1YWwgb2YgZWxlbWVudCBieSBkZWZhdWx0JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgY29uc3QgaW1nRWxlbWVudCA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgICAgZHJpdmVyLl9pbWdFbENhY2hlLnNldChpbWdFbGVtZW50LmlkLCBpbWdFbGVtZW50KTtcbiAgICAgIGF3YWl0IEltYWdlRWxlbWVudC5leGVjdXRlKGRyaXZlciwgJ2dldEF0dHJpYnV0ZScsIGltZ0VsZW1lbnQuaWQsICd2aXN1YWwnKVxuICAgICAgICAuc2hvdWxkLmV2ZW50dWFsbHkuZXFsKG51bGwpO1xuICAgIH0pO1xuICAgIGl0KCdzaG91bGQgbm90IGdldCBvdGhlciBhdHRyaWJ1dGUnLCBhc3luYyBmdW5jdGlvbiAoKSB7XG4gICAgICBhd2FpdCBJbWFnZUVsZW1lbnQuZXhlY3V0ZShkcml2ZXIsICdnZXRBdHRyaWJ1dGUnLCBpbWdFbC5pZCwgJ2NvbnRlbnQtZGVzYycpXG4gICAgICAgIC5zaG91bGQuZXZlbnR1YWxseS5yZWplY3RlZFdpdGgoJ01ldGhvZCBoYXMgbm90IHlldCBiZWVuIGltcGxlbWVudGVkJyk7XG4gICAgfSk7XG4gICAgaXQoJ3Nob3VsZCBjbGljayBlbGVtZW50JywgYXN5bmMgZnVuY3Rpb24gKCkge1xuICAgICAgYXdhaXQgSW1hZ2VFbGVtZW50LmV4ZWN1dGUoZHJpdmVyLCAnY2xpY2snLCBpbWdFbC5pZClcbiAgICAgICAgLnNob3VsZC5ldmVudHVhbGx5LmJlLnRydWU7XG4gICAgfSk7XG4gIH0pO1xufSk7XG5cbmRlc2NyaWJlKCdpbWFnZSBlbGVtZW50IExSVSBjYWNoZScsIGZ1bmN0aW9uICgpIHtcbiAgaXQoJ3Nob3VsZCBhY2NlcHQgYW5kIGNhY2hlIGltYWdlIGVsZW1lbnRzJywgZnVuY3Rpb24gKCkge1xuICAgIGNvbnN0IGVsMSA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgIGNvbnN0IGVsMiA9IG5ldyBJbWFnZUVsZW1lbnQoZGVmVGVtcGxhdGUsIGRlZlJlY3QpO1xuICAgIGNvbnN0IGNhY2hlID0gbWFrZUltYWdlRWxlbWVudENhY2hlKCk7XG4gICAgY2FjaGUuc2V0KGVsMS5pZCwgZWwxKTtcbiAgICBlbDEuZXF1YWxzKGNhY2hlLmdldChlbDEuaWQpKS5zaG91bGQuYmUudHJ1ZTtcbiAgICBfLmlzVW5kZWZpbmVkKGNhY2hlLmdldChlbDIuaWQpKS5zaG91bGQuYmUudHJ1ZTtcbiAgICBjYWNoZS5oYXMoZWwxLmlkKS5zaG91bGQuYmUudHJ1ZTtcbiAgICBjYWNoZS5oYXMoZWwyLmlkKS5zaG91bGQuYmUuZmFsc2U7XG4gIH0pO1xuICBpdCgnb25jZSBjYWNoZSByZWFjaGVzIG1heCBzaXplLCBzaG91bGQgZWplY3QgaW1hZ2UgZWxlbWVudHMnLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3QgZWwxID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgY29uc3QgZWwyID0gbmV3IEltYWdlRWxlbWVudChkZWZUZW1wbGF0ZSwgZGVmUmVjdCk7XG4gICAgY29uc3QgY2FjaGUgPSBtYWtlSW1hZ2VFbGVtZW50Q2FjaGUoZGVmVGVtcGxhdGUubGVuZ3RoICsgMSk7XG4gICAgY2FjaGUuc2V0KGVsMS5pZCwgZWwxKTtcbiAgICBjYWNoZS5oYXMoZWwxLmlkKS5zaG91bGQuYmUudHJ1ZTtcbiAgICBjYWNoZS5zZXQoZWwyLmlkLCBlbDIpO1xuICAgIGNhY2hlLmhhcyhlbDIuaWQpLnNob3VsZC5iZS50cnVlO1xuICAgIGNhY2hlLmhhcyhlbDEuaWQpLnNob3VsZC5iZS5mYWxzZTtcbiAgfSk7XG59KTtcblxuZGVzY3JpYmUoJ2dldEltZ0VsRnJvbUFyZ3MnLCBmdW5jdGlvbiAoKSB7XG4gIGl0KCdzaG91bGQgcmV0dXJuIHRoZSBpbWFnZSBlbGVtZW50IGlkIGZyb20ganNvbiBvYmogaW4gYXJncycsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBpbWdFbCA9IGAke0lNQUdFX0VMRU1FTlRfUFJFRklYfWZvb2A7XG4gICAgY29uc3QgYXJncyA9IFsxLCAnZm9vJywgaW1nRWxdO1xuICAgIGdldEltZ0VsRnJvbUFyZ3MoYXJncykuc2hvdWxkLmVxbChpbWdFbCk7XG4gIH0pO1xuICBpdCgnc2hvdWxkIG5vdCByZXR1cm4gYW55dGhpbmcgaWYgaW1hZ2UgZWxlbWVudCBpZCBub3QgaW4gYXJncycsIGZ1bmN0aW9uICgpIHtcbiAgICBjb25zdCBhcmdzID0gWzEsICdmb28nXTtcbiAgICBfLmlzVW5kZWZpbmVkKGdldEltZ0VsRnJvbUFyZ3MoYXJncykpLnNob3VsZC5iZS50cnVlO1xuICB9KTtcbiAgaXQoJ3Nob3VsZCBub3QgZmluZCBpbWFnZSBlbGVtZW50IGlkIGluIGFueXRoaW5nIGJ1dCBwcmVmaXgnLCBmdW5jdGlvbiAoKSB7XG4gICAgY29uc3Qgbm90SW1nRWwgPSBgZm9vJHtJTUFHRV9FTEVNRU5UX1BSRUZJWH1gO1xuICAgIGNvbnN0IGFyZ3MgPSBbMSwgJ2ZvbycsIG5vdEltZ0VsXTtcbiAgICBfLmlzVW5kZWZpbmVkKGdldEltZ0VsRnJvbUFyZ3MoYXJncykpLnNob3VsZC5iZS50cnVlO1xuICB9KTtcbn0pO1xuIl0sImZpbGUiOiJ0ZXN0L2Jhc2Vkcml2ZXIvaW1hZ2UtZWxlbWVudC1zcGVjcy5qcyIsInNvdXJjZVJvb3QiOiIuLi8uLi8uLiJ9
